--- 
layout: page
title: Formal Analysis of SAML 2.0 Web Browser Single Sign-On: Breaking the SAML-based Single Sign-On for Google Apps
---

[Alessandro Armando](http://csec.it/people/alessandro_armando/) (University of Genova, Italy), Roberto Carbone (University of Genova, Italy), Luca Compagna (SAP Research, France), Jorge Cuellar (Siemens AG, Germany), Llanos Tobarra Abad (Universidad de Castilla-La Mancha, Spain)

_Abstract._ Single-Sign-On (SSO) protocols enable companies to establish a federated environment in which clients sign in the system once and yet are able to access to services offered by different companies. The OASIS Security Assertion Markup Language (SAML) 2.0 Web Browser SSO Profile is the emerging standard in this context. In this paper we provide formal models of the protocol corresponding to one of the most applied use case scenario (the SP-Initiated SSO with Redirect/POST Bindings) and of a variant of the protocol implemented by Google and currently in use by Google's customers (the SAML-based SSO for Google Applications). We have mechanically analysed these formal models with SATMC, a state-of-the-art model checker for security protocols. SATMC has revealed a severe security flaw in the protocol used by Google that allows a dishonest service provider to impersonate a user at another service provider. We have also reproduced this attack in an actual deployment of the SAML-based SSO for Google Applications. This security flaw of the SAML-based SSO for Google Applications was previously unknown.

Presented at the [6th ACM Workshop on Formal Methods in Security Engineering (FMSE 2008)](http://www.cs.utexas.edu/~shmat/FMSE08/), October 27th, 2008, Hilton Alexandria Mark Center, Virginia, USA.

[BibTeX](fmse2008.bib) [PDF](http://www.ai-lab.it/armando/pub/fmse9-armando.pdf)

### Demo

<object width="425" height="344"><param name="movie" value="http://www.youtube.com/v/O202FBcQNuk?hl=en&fs=1"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/O202FBcQNuk?hl=en&fs=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="425" height="344"></embed></object>
  
We are grateful to the following people who contributed to the realization of the video: Roberto Basile (implementation) and Sophie Galbraith (voice).

### Further information

*   Vulnerability reports:
    *   US-CERT [Vulnerability Note VU#612636 "Google SAML Single Sign on vulnerability"](http://www.kb.cert.org/vuls/id/612636) (see also [Google Information for Vulnerability Note VU#612636](http://www.kb.cert.org/vuls/id/MIMG-7FQGWU))
    *   NIST National Vulnerability Database Vulnerability [CVE-2008-3891](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2008-3891)
    *   Common Vulnerabilities and Exposures: [CVE-2008-3891](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3891)
*   Acknowledgments by Google:
    *   [Google Corporate Information](http://www.google.com/corporate/security.html)
    *   [Message posted on the "Google Apps APIs" group](http://groups.google.com/group/google-apps-apis/browse_thread/thread/8183040d7980a2e0)
*   Google Apps: [Web page of Google Apps](http://www.google.com/apps/), [Press release on Google Apps](http://www.google.com/intl/en/press/pressrel/google_apps.html)
*   On the Press: Il Secolo XIX ([page 1](press/IlSecoloXIX-p1.pdf), [page 8](press/IlSecoloXIX-p8.pdf)), [La Stampa](http://www.lastampa.it/cmstp/rubriche/girata.asp?ID_blog=30&ID_articolo=5070&tp=C), [Il Punto Informatico](http://punto-informatico.it/2397938/PI/News/cosi-scoprimmo-buco-google.aspx), Heise online ([UK](http://www.h-online.com/news/Google-closes-hole-in-Single-Sign-On-for-Google-Apps--/111500), [D](http://www.heise.de/netze/Google-schliesst-Luecke-in-Single-Sign-On-for-Google-Apps--/news/meldung/115711)), [ZDNet](http://blogs.zdnet.com/security/?p=1880), [IT World](http://www.itworld.com/saas/54721/google-fixes-major-weakness-google-apps), [IT Media](http://www.itmedia.co.jp/news/articles/0809/11/news023.html).
*   Security Blogs:
    *   [Kim Cameron's Identity Weblog](http://www.identityblog.com/?p=1011)
    *   [Korean Identity Weblog](http://ayo79.egloos.com/2541457)
    *   [Conor's Web Log of Esoterica](http://conorcahill.blogspot.com/2008/09/pseudonymity-would-help.html)
    *   [Jackson's Identity Management & Active Directory Reality Tour Travelblog](http://jacksonshaw.blogspot.com/2008/09/google-age-and-single-sign-on.html)
    *   [XML Networking](http://xmlnetworking.blogspot.com/2008/09/google-saml-vulnerability.html)

* * *

This work has been partially supported by the FP7-ICT-2007-1 Project no. 216471, [AVANTSSAR: Automated Validation of Trust and Security of Service-oriented Architectures](http://www.avantssar.eu)
